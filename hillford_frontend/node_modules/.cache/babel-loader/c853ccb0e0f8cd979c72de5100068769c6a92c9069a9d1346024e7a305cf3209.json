{"ast":null,"code":"import axios from \"axios\";\nimport { push } from \"connected-react-router\";\nimport { toast } from \"react-toastify\";\nimport { SET_TOKEN, SET_CURRENT_USER, UNSET_CURRENT_USER } from \"./LoginTypes\";\nimport { setAxiosAuthToken, toastOnError } from \"../../utils/Utils\";\nexport const login = (userData, redirectTo) => dispatch => {\n  axios.post(\"/login/\", userData).then(response => {\n    const {\n      auth_token\n    } = response.data;\n    setAxiosAuthToken(auth_token);\n    dispatch(setToken(auth_token));\n    dispatch(getCurrentUser(redirectTo));\n  }).catch(error => {\n    dispatch(unsetCurrentUser());\n    toastOnError(error);\n  });\n};\nexport const getCurrentUser = redirectTo => dispatch => {\n  axios.get(\"/api/v1/users/me/\").then(response => {\n    const user = {\n      username: response.data.username,\n      email: response.data.email\n    };\n    dispatch(setCurrentUser(user, redirectTo));\n  }).catch(error => {\n    dispatch(unsetCurrentUser());\n    if (error.response) {\n      if (error.response.status === 401 && error.response.hasOwnProperty(\"data\") && error.response.data.hasOwnProperty(\"detail\") && error.response.data[\"detail\"] === \"User inactive or deleted.\") {\n        dispatch(push(\"/resend_activation\"));\n      }\n    } else {\n      toastOnError(error);\n    }\n  });\n};\nexport const setCurrentUser = (user, redirectTo) => dispatch => {\n  localStorage.setItem(\"user\", JSON.stringify(user));\n  dispatch({\n    type: SET_CURRENT_USER,\n    payload: user\n  });\n  if (redirectTo !== \"\") {\n    dispatch(push(redirectTo));\n  }\n};\nexport const setToken = token => dispatch => {\n  setAxiosAuthToken(token);\n  localStorage.setItem(\"token\", token);\n  dispatch({\n    type: SET_TOKEN,\n    payload: token\n  });\n};\nexport const unsetCurrentUser = () => dispatch => {\n  setAxiosAuthToken(\"\");\n  localStorage.removeItem(\"token\");\n  localStorage.removeItem(\"user\");\n  dispatch({\n    type: UNSET_CURRENT_USER\n  });\n};\nexport const logout = () => dispatch => {\n  axios.post(\"/logout/\").then(response => {\n    dispatch(unsetCurrentUser());\n    dispatch(push(\"/\"));\n    toast.success(\"Logout successful.\");\n  }).catch(error => {\n    dispatch(unsetCurrentUser());\n    toastOnError(error);\n  });\n};","map":{"version":3,"names":["axios","push","toast","SET_TOKEN","SET_CURRENT_USER","UNSET_CURRENT_USER","setAxiosAuthToken","toastOnError","login","userData","redirectTo","dispatch","post","then","response","auth_token","data","setToken","getCurrentUser","catch","error","unsetCurrentUser","get","user","username","email","setCurrentUser","status","hasOwnProperty","localStorage","setItem","JSON","stringify","type","payload","token","removeItem","logout","success"],"sources":["C:/Users/Joy/El/Projects/Full Stack/Hillford/hillford_frontend/src/components/login/LoginActions.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { push } from \"connected-react-router\";\r\nimport { toast } from \"react-toastify\";\r\nimport { SET_TOKEN, SET_CURRENT_USER, UNSET_CURRENT_USER } from \"./LoginTypes\";\r\nimport { setAxiosAuthToken, toastOnError } from \"../../utils/Utils\";\r\n\r\nexport const login = (userData, redirectTo) => dispatch => {\r\n  axios\r\n    .post(\"/login/\", userData)\r\n    .then(response => {\r\n      const { auth_token } = response.data;\r\n      setAxiosAuthToken(auth_token);\r\n      dispatch(setToken(auth_token));\r\n      dispatch(getCurrentUser(redirectTo));\r\n    })\r\n    .catch(error => {\r\n      dispatch(unsetCurrentUser());\r\n      toastOnError(error);\r\n    });\r\n};\r\n\r\nexport const getCurrentUser = redirectTo => dispatch => {\r\n  axios\r\n    .get(\"/api/v1/users/me/\")\r\n    .then(response => {\r\n      const user = {\r\n        username: response.data.username,\r\n        email: response.data.email\r\n      };\r\n      dispatch(setCurrentUser(user, redirectTo));\r\n    })\r\n    .catch(error => {\r\n      dispatch(unsetCurrentUser());\r\n      if (error.response) {\r\n        if (\r\n          error.response.status === 401 &&\r\n          error.response.hasOwnProperty(\"data\") &&\r\n          error.response.data.hasOwnProperty(\"detail\") &&\r\n          error.response.data[\"detail\"] === \"User inactive or deleted.\"\r\n        ) {\r\n          dispatch(push(\"/resend_activation\"));\r\n        }\r\n      } else {\r\n        toastOnError(error);\r\n      }\r\n    });\r\n};\r\n\r\nexport const setCurrentUser = (user, redirectTo) => dispatch => {\r\n  localStorage.setItem(\"user\", JSON.stringify(user));\r\n  dispatch({\r\n    type: SET_CURRENT_USER,\r\n    payload: user\r\n  });\r\n\r\n  if (redirectTo !== \"\") {\r\n    dispatch(push(redirectTo));\r\n  }\r\n};\r\n\r\nexport const setToken = token => dispatch => {\r\n  setAxiosAuthToken(token);\r\n  localStorage.setItem(\"token\", token);\r\n  dispatch({\r\n    type: SET_TOKEN,\r\n    payload: token\r\n  });\r\n};\r\n\r\nexport const unsetCurrentUser = () => dispatch => {\r\n  setAxiosAuthToken(\"\");\r\n  localStorage.removeItem(\"token\");\r\n  localStorage.removeItem(\"user\");\r\n  dispatch({\r\n    type: UNSET_CURRENT_USER\r\n  });\r\n};\r\n\r\nexport const logout = () => dispatch => {\r\n  axios\r\n    .post(\"/logout/\")\r\n    .then(response => {\r\n      dispatch(unsetCurrentUser());\r\n      dispatch(push(\"/\"));\r\n      toast.success(\"Logout successful.\");\r\n    })\r\n    .catch(error => {\r\n      dispatch(unsetCurrentUser());\r\n      toastOnError(error);\r\n    });\r\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}